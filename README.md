# 🎭 动态表情生成器

一个基于Web的动态表情包生成工具，支持上传图片/视频，添加动态文字效果，并导出为GIF格式。

## ✨ 功能特点

- 📁 **多媒体支持**：支持上传JPG、PNG、GIF图片和MP4、WebM视频
- 🎨 **1:1画布预览**：300x300像素的正方形预览区域
- 📝 **文字叠加**：可自定义文字内容、颜色、大小和位置
- 🎬 **动画效果**：提供5种文字动画效果
  - 跳动效果
  - 渐变闪烁  
  - 旋转缩放
  - 弹性摆动
  - 打字机效果
- 🎨 **字体选择器**：支持多种中文字体，带实时预览
- 🎞️ **GIF生成**：使用gif.js库生成高质量GIF动画
- ▶️ **智能播放**：上传文件后自动播放预览，暂停状态智能提醒
- 💬 **微信优化**：智能压缩算法，确保1MB文件大小限制
- 💾 **一键导出**：支持下载生成的GIF文件
- 📱 **响应式设计**：适配桌面和移动设备

## 🚀 快速开始

### 环境要求

- 现代浏览器（支持Canvas和Web Workers）
- 本地HTTP服务器（用于正确加载Web Worker）

### 运行方法

1. **下载项目文件**
   ```bash
   # 将项目文件下载到本地目录
   ```

2. **启动HTTP服务器**
   ```bash
   # 使用Python
   python -m http.server 8000
   
   # 或使用Node.js
   npx http-server
   
   # 或使用PHP
   php -S localhost:8000
   ```

3. **访问应用**
   ```
   http://localhost:8000/dynamic-emoji-generator/
   ```

## 📖 使用说明

### 1. 上传素材
- 点击上传区域或拖拽文件到上传区域
- 支持多文件上传（无数量限制）
- 系统会自动按文件名排序
- 支持拖拽调整文件顺序
- 系统会自动验证文件格式
- 上传成功后预览区域会自动开始播放

### 2. 添加文字
- 在"输入文字"框中输入要显示的文字
- 从字体选择器中选择合适的字体（支持中文字体预览）
- 调节字体大小（12-60px）
- 选择文字颜色
- 调整文字位置（X、Y坐标）

### 3. 选择动画效果
- 从下拉菜单中选择动画类型
- 实时预览动画效果

### 4. 生成GIF
- 设置GIF持续时间（1-10秒）
- 调整画质参数（1-20，数值越小质量越高）
- 可选择开启微信优化（自动压缩到1MB以内）
- 确保预览区域正在播放（暂停状态会弹出提醒对话框）
- 点击"生成GIF"按钮
- 等待处理完成（显示进度条和压缩状态）

### 5. 下载结果
- 生成完成后在结果预览区查看
- 点击"下载"按钮保存GIF文件

## 🛠️ 技术实现

### 核心技术栈
- **HTML5 Canvas**：图形渲染和动画实现
- **gif.js**：GIF图像生成库
- **Web Workers**：后台处理避免界面阻塞
- **CSS3**：响应式布局和动画效果
- **Vanilla JavaScript**：原生JS实现所有功能

### 项目结构
```
dynamic-emoji-generator/
├── index.html          # 主页面
├── css/
│   └── style.css       # 样式文件
├── js/
│   ├── app.js          # 主要应用逻辑
│   ├── gif.js          # GIF编码库
│   └── gif.worker.js   # GIF生成Web Worker
├── http-server.bat     # Windows服务器启动脚本
├── CLAUDE.md           # 开发指南
└── README.md           # 说明文档
```

### 关键实现
1. **文件上传**：支持拖拽上传和点击选择
2. **媒体处理**：自动识别图片和视频，适配1:1比例
3. **动画系统**：基于requestAnimationFrame的流畅动画
4. **智能播放控制**：自动播放预览，暂停状态生成GIF前智能提醒
5. **WeChat优化**：智能压缩算法，自动调整参数确保1MB以内
6. **GIF生成**：使用Web Workers异步处理，避免界面卡顿

## ⚠️ 使用限制

- 最大输出尺寸：300x300像素
- GIF文件大小：建议控制在1MB以内
- 文字长度：最多50个字符
- 同时上传文件：无数量限制
- 支持格式：JPG、PNG、GIF、MP4、WebM

## 🔧 自定义配置

可以通过修改`app.js`中的参数来调整功能：

```javascript
// 画布尺寸
this.canvas.width = 300;
this.canvas.height = 300;

// 动画速度
this.animationSpeed = 0.05;

// 媒体切换间隔（秒）
const switchInterval = 3;

// GIF帧率
const fps = 10;
```

## 🐛 故障排除

### 常见问题

1. **GIF生成失败**
   - 确保使用HTTP服务器访问，不要直接打开HTML文件
   - 检查浏览器是否支持Web Workers

2. **文件上传失败**
   - 检查文件格式是否支持
   - 确认文件大小不超过浏览器限制

3. **动画不流畅**
   - 减少同时处理的文件数量
   - 降低GIF质量参数

4. **生成静态GIF**
   - 如果预览区域处于暂停状态，生成GIF时会弹出提醒对话框
   - 可选择开始播放生成动态GIF，或继续生成静态GIF

5. **页面显示异常**
   - 清除浏览器缓存
   - 检查控制台是否有错误信息

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

---

🎉 现在就开始创建你的专属动态表情包吧！